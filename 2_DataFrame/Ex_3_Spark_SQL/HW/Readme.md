Take Titanic dataset
Load data into dataframe
Find amount of passengers in each class
Find proportion of survived passengers in each class
Calculate average age in each group, where the group is defined by sex, pclass, survived or not

Use Spark SQL queries to find the proportion of survived passengers on each route embarked-homedest

Optional Write the UDF function that extracts state from homedest to improve previous query
